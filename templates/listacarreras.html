{% extends 'base.html' %}

{% block title %}Lista de Carreras{% endblock %}

{% block content %}
<h1 style="color: white; text-align: center; margin-bottom: 30px;">
    Lista de Programas de la Universidad de Colombia
</h1>

<div style="background: white; border-radius: 10px; padding: 20px; margin: 20px auto; max-width: 1000px;">
    <div style="display:flex; gap:1.5rem; flex-wrap:wrap; align-items:flex-start;">
        <div style="flex:1; min-width:320px;">
            <h4>Agregar Nueva Carrera</h4>
            {% if mensaje %}
                <div class="alert alert-warning" role="alert">{{ mensaje }}</div>
            {% endif %}
            <form action="{{ url_for('agregar_carrera') }}" method="POST">
                <div class="mb-3">
                    <label for="codigo" class="form-label">Código</label>
                    <input type="text" name="codigo" id="codigo" class="form-control" placeholder="Ej: ING001" required>
                </div>
                <div class="mb-3">
                    <label for="nombre" class="form-label">Nombre de la Carrera</label>
                    <input type="text" name="nombre" id="nombre" class="form-control" placeholder="Ej: Ingeniería de Sistemas" required>
                </div>
                <div class="d-flex gap-2">
                    <button class="btn btn-primary" type="submit">Agregar Carrera</button>
                    <a href="{{ url_for('programas') }}" class="btn btn-outline-secondary">Ver Programas</a>
                </div>
            </form>
        </div>

        <div style="flex:2; min-width:300px;">
            <h4>Listado de Carreras</h4>
            <table class="table table-striped" style="margin: 0;">
                <thead style="background: #1a365d; color: white;">
                    <tr>
                        <th style="padding: 12px; text-align: center;">CÓDIGO</th>
                        <th style="padding: 12px; text-align: center;">CARRERA</th>
                        <th style="padding: 12px; text-align: center;">ACCIONES</th>
                    </tr>
                </thead>
                <tbody>
                    {% if Carreras %}
                        {% for registro in Carreras %}
                            <tr>
                                <td style="text-align:center; font-weight:bold; color:#1a365d;">{{ registro.0 }}</td>
                                <td>{{ registro.1 }}</td>
                                <td style="text-align:center;">
                                    <a href="{{ url_for('actualizar', codigo=registro.0) }}" class="btn btn-sm btn-warning">Actualizar</a>
                                    <a href="{{ url_for('eliminar', codigo=registro.0) }}" class="btn btn-sm btn-danger" onclick="return confirm('¿Eliminar la carrera {{ registro.1 }}?');">Eliminar</a>
                                </td>
                            </tr>
                        {% endfor %}
                    {% else %}
                        <tr><td colspan="3" style="padding:20px; text-align:center; color:#666;">No hay carreras registradas.</td></tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Debug: Mostrar información -->
<div style="background: rgba(255,255,255,0.1); padding: 15px; margin: 20px; border-radius: 10px; color: white;">
    <h4>Información de Debug:</h4>
    <p>Total de carreras encontradas: {{ Carreras|length if Carreras else 0 }}</p>
    {% if Carreras %}
        <p>Datos disponibles: SÍ</p>
        <p>Primera carrera: {{ Carreras[0][0] }} - {{ Carreras[0][1] }}</p>
    {% else %}
        <p>Datos disponibles: NO</p>
        <p style="color: #ffc107;">Posible problema: La variable 'Carreras' está vacía o no se está pasando desde main.py</p>
    {% endif %}
</div>

<div style="text-align: center; margin: 30px 0;">
    <a href="{{ url_for('programas') }}" 
       style="background: #1a365d; color: white; padding: 12px 25px; border-radius: 8px; 
              text-decoration: none; margin-right: 15px; font-weight: bold;">
         Registrar Materias
    </a>
    <a href="{{ url_for('index') }}" 
       style="background: transparent; color: white; border: 2px solid white; padding: 12px 25px; 
              border-radius: 8px; text-decoration: none; font-weight: bold;">
         Volver al Inicio
    </a>
</div>

{% endblock %}